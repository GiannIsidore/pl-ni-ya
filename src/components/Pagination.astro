---
interface Props {
  currentPage: number;
  totalPages: number;
  baseUrl: string;
}

const { currentPage, totalPages, baseUrl } = Astro.props;

function getPageNumbers(current: number, total: number): (number | string)[] {
  const pages: (number | string)[] = [];
  
  if (total <= 7) {
    // Show all pages if 7 or fewer
    for (let i = 1; i <= total; i++) {
      pages.push(i);
    }
  } else {
    // Always show first page
    pages.push(1);
    
    if (current > 3) {
      pages.push('...');
    }
    
    // Show pages around current
    const start = Math.max(2, current - 1);
    const end = Math.min(total - 1, current + 1);
    
    for (let i = start; i <= end; i++) {
      pages.push(i);
    }
    
    if (current < total - 2) {
      pages.push('...');
    }
    
    // Always show last page
    pages.push(total);
  }
  
  return pages;
}

const pageNumbers = getPageNumbers(currentPage, totalPages);
---

<div class="pagination flex items-center justify-center gap-2 my-8">
  {currentPage > 1 && (
    <a
      href={`${baseUrl}?page=${currentPage - 1}`}
      class="px-3 py-2 text-sm text-gray-400 hover:text-white border border-neutral-700 rounded hover:bg-neutral-800 transition-colors"
    >
      Previous
    </a>
  )}
  
  {pageNumbers.map((page) => {
    if (page === '...') {
      return (
        <span class="px-3 py-2 text-sm text-gray-500">...</span>
      );
    }
    
    const pageNum = page as number;
    const isActive = pageNum === currentPage;
    
    return (
      <a
        href={`${baseUrl}?page=${pageNum}`}
        class={`px-3 py-2 text-sm rounded transition-colors ${
          isActive
            ? 'bg-blue-600 text-white'
            : 'text-gray-400 hover:text-white border border-neutral-700 hover:bg-neutral-800'
        }`}
      >
        {pageNum}
      </a>
    );
  })}
  
  {currentPage < totalPages && (
    <a
      href={`${baseUrl}?page=${currentPage + 1}`}
      class="px-3 py-2 text-sm text-gray-400 hover:text-white border border-neutral-700 rounded hover:bg-neutral-800 transition-colors"
    >
      Next
    </a>
  )}
</div>
